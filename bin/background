#!/bin/bash

if [ -z "$1" ]; then
    if [ "$BACKGROUND" ]; then
        echo $BACKGROUND
        exit 0
    fi

    if [ -r ~/.config/background ]; then
        cat ~/.config/background
    else
        echo light
    fi

    exit 0
fi

echo $1 > ~/.config/background

export BACKGROUND=$1
xrdb -merge ~/.Xresources.$1
cat ~/.i3/config.base ~/.i3/config.$1 > ~/.i3/config
ln -fs ~/bin/dmenu.$1 ~/bin/dmenu
sudo gdb -ex 'attach '`pgrep -x i3` -ex 'call putenv("BACKGROUND='$1'")' -ex 'detach' -ex 'quit' &> /dev/null
i3-msg reload &> /dev/null

#!/bin/bash

wlan_interface=$(ip l | grep -m1 --color=never -Po '^\d+: \Kw[^:]+')

interface=${1:-$wlan_interface}

echo -n "restarting netctl-auto... "
sudo systemctl restart netctl-auto@$interface
echo ok

echo -n "waiting for address..."
until inet_output=$(ip addr show dev $interface | grep -o 'inet .*'); do
    echo -n .
    sleep 0.5
done

echo " ok"
echo $inet_output
